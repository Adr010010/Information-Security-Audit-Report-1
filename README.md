# Information-Security-Audit-Report-1 Site-admin: @lambdaprotect

> **ОТКАЗ ОТ ОТВЕТСТВЕННОСТИ:** Все действия были сделаны в онлайн-игре ГТА 5 РП на виртуальной тачке с лицензиями. Данные ниже не являются валидными и представлены исключительно в виде демонстрации без предоставления полного скрипта.

**Статус:** КРИТИЧЕСКИЙ (CRITICAL)  
**Объект:** Система авторизации и управления данными пользователей

---

## 1. Обход авторизации (Broken Authentication)

### Обнаружение (Discovery)
В ходе анализа было выявлено, что сайт использует JWT-токены для авторизации, которые хранятся в `localStorage` под ключом `access_token`. При декодировании стандартного токена (алгоритм HS256) были обнаружены технические данные и номер телефона пользователя.

### Гипотеза
Проверка сервера на устойчивость к атаке **"None Algorithm"**. Суть уязвимости заключается в том, что сервер может принимать токены без цифровой подписи, если в заголовке указано `"alg": "none"`.

### Реализация (Chain of Actions)
Был написан эксплойт на JavaScript для генерации поддельного токена:
1.  **Header:** Установлен алгоритм `none`.
2.  **Payload:** Указан номер телефона цели (`+777777777777`).
3.  **Инъекция:** С помощью консоли браузера новый токен был принудительно записан в `localStorage`, а кэш приложения (`persist:root`) очищен для принудительного обновления сессии.

**Результат:** После перезагрузки страницы сервер принял токен без подписи. Был получен полный доступ к чужому профилю, зная только номер телефона.

---

## 2. Повышение привилегий (Privilege Escalation)

### Анализ логики (Client-Side Reconnaissance)
Поиск по исходному коду (Sources) выявил, что права администратора на фронтенде определяются флагами `is_admin`, `role` и `permissions`.

### Манипуляция состоянием (State Injection)
Была проведена атака на логику клиентской части (Client-Side Logic Manipulation):
1.  **Вскрытие хранилища:** Извлечен объект `persist:root`, содержащий состояние Redux.
2.  **Инъекция прав:** В объект пользователя были вручную добавлены параметры:
    ```javascript
    user.is_admin = true;
    user.role = 'admin';
    user.permissions = ['all'];
    ```
3.  **Сохранение:** Измененное состояние было упаковано обратно в JSON и сохранено в память браузера.

**Результат:** Приложение React «поверило» поддельным данным. В интерфейсе открылись скрытые разделы: «Менеджеры», «Статистика системы», «Финансы и тарифы».

---

## 3. Массовая утечка данных (Mass Data Leak)

### Извлечение базы пользователей
В процессе глубокого анализа состояния Redux (`parsedData`) было обнаружено, что в кэш администратора подгружаются массивы данных о других пользователях.

**Выявленные данные:**
* **Личная информация:** ФИО, Email, номера телефонов.
* **Авторизация:** Действующие JWT-токены других пользователей. Это позволяет осуществлять Account Takeover в промышленных масштабах без использования эксплойтов — достаточно просто подставить чужой готовый токен.
* **Платежные реквизиты:** В массивах `payMethods` обнаружены привязанные кошельки YooMoney (например, `410013421xxxxxx`) и маскированные данные банковских карт.

---

## Итоговый вердикт

Цепочка уязвимостей позволяет осуществить полный захват платформы.

| Уязвимость | Описание |
| :--- | :--- |
| **JWT Authentication Bypass** | Сервер доверяет токенам с `alg: none`, позволяя войти в любой аккаунт. |
| **Trusting Client-Side State** | Интерфейс открывает админ-панель на основе легко изменяемых данных в `localStorage`. |
| **Insecure Data Storage** | Конфиденциальные данные всех пользователей (включая токены) хранятся в открытом кэше фронтенда. |
| **Sensitive Data Exposure** | Утечка платежных реквизитов нарушает стандарты безопасности финансовых данных. |

**Риск:** `CRITICAL`. Злоумышленник может похитить средства, персональные данные или полностью парализовать работу сервиса.

---

## Рекомендации по устранению

* **Бэкенд:** Строго запретить использование алгоритма `none` в библиотеках JWT. Проверять подпись только по секретному ключу (HS256/RS256).
* **Доступ:** Реализовать проверку прав (RBAC) исключительно на сервере. Бэкенд не должен выдавать данные админки, если токен не принадлежит реальному администратору.
* **Хранение:** Никогда не передавать и не хранить в `localStorage` данные других пользователей или их токены.
